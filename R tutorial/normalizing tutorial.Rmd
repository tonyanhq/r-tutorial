---
title: "R tutorial"
output:
  html_document:
    df_print: paged
---

1、向没有编程和R语言基础的非统计、计算机等专业的本科生，介绍R语言中的某一个函数、语法、package等任意一个功能，内容自选。但需要注意：
（1）对该函数/语法/package的意义和用法进行说明
（2）包含R语言代码
（3）对代码进行详细的解释、说明
（4）格式规范

knn() 函数
K-Nearest Neighbor Classification：机器学习中最简单和容易理解的一个监督学习模型，基于贝叶斯定理和条件概率，适用于分类变量（qulitative variable）的预测。
原理：利用欧式距离（Euclidean distance）选取离目标点最近的N个点，将这N个点中数量最多的类型当作目标点的类型。
```{r}
# 用鸢尾花数据集iris举例, 前四个变量是花的四种特征，最后一个变量是花的类型
data(iris)
# 加载数据集
iris 
# 查看数据集内容
```

```{r}
dt = sort(sample(nrow(iris), nrow(iris)*.7)) 
#将数据集分成训练集和测试集，其比例为7:3
train <- iris[dt,1:4]
test <- iris[-dt,1:4]
train_target <- iris[dt, 5]
test_target <- iris[-dt, 5]
cat("The shape of iris dataset is", dim(iris), "\n")
cat("The shape of train dataset is", dim(train), "\n")
cat("The shape of test dataset is", dim(test), "\n")
```

```{r}
library(class)
set.seed(1)
# 设置一个随机数种子，使每次运行knn()结果相同
pred = knn(train, test, train_target, k=5)
# 用knn()函数拟合训练集数据和训练集结果，对测试集数据进行预测。
table = table(pred, test_target)
table
# 用table()函数生成混淆矩阵（Confusion Matrix），用来计算预测精度。
accuracy1 = (15+13+16)/45
cat("accuracy1 is", accuracy1, "\n")
# 利用混淆矩阵计算精度accuracy = (TP + TN)/(P + N) 
accuracy2 = mean(pred==test_target)
cat("accuracy2 is", accuracy2, "\n")
# 用mean()函数直接计算精度，原理同上
```
由计算得出的精度可知，当k值设为5时，对测试集预测的结果为0.98


2、向没有编程和R语言基础的非统计、计算机等专业的本科生，介绍任意一个常用统计学公式及示例，用R语言实现并作解释。

将偏态变量正态化（使数据符合分析时做出的基本假设）

a. 读取数据
```{r}
train <- read.csv("train.csv")
# 读取数据：从数据集中读取一个csv表格数据
# train是这个数据集的名字，此时这个数据集的类型是dataframe
train
# 查看已经读区的数据集
```

b. 取出一个数值型变量，从图形和偏态数值两方面来观察此变量的偏态程度
```{r}
# 1.画柱状图观察变量偏态分布程度
# 调用ggplot函数
library(ggplot2)
library(scales)
ggplot(data = train,                 # 给定数据集
       aes(x=SalePrice))+            # 需要被绘制的变量
        geom_histogram(fill="blue", binwidth = 10000) +       #绘制柱形图
        scale_x_continuous(breaks= seq(0, 800000, by=100000), 
                           labels = comma)                    #x轴数字呈现方式
```
从图中我们可以看到，该变量呈现左偏分布
```{r}
# 2. 通过偏态系数查看变量偏态分布程度
library(moments)
skew_score = skewness(train$SalePrice)
cat("The skewness of this variable is", skew_score) # cat()函数：打印
```

在一般情形下，当统计数据为右偏分布时，Sk(偏态系数)>0，且Sk值越大，右偏程度越高；
当统计数据为左偏分布时，Sk<0，且Sk值越小，左偏程度越高。
当统计数据为对称分布（即正态分布）时，有Sk= 0。
（摘自百度百科）
由该变量的偏态系数可知，该变量呈现左偏分布。

c.偏态变量正态化
```{r}
train$SalePrice <- log(train$SalePrice)        #用log()函数对变量进行正态化
skew_score_nor = skewness(train$SalePrice)     #再次测量该变量的偏态系数
cat("The skewness of this variable after normalizing is", skew_score_nor)
```
```{r}
ggplot(data = train, aes(x=SalePrice)) + geom_histogram(fill="blue", binwidth = 0.06)
```
从偏态系数和柱状图的改变可以看出，之前的处理基本实现了数据的正态化分布